# 工业探伤FPGA程序说明

作者：李琛

## ARM下发参数说明

| 地址   | 变量            | 说明                                                         |
| ------ | --------------- | ------------------------------------------------------------ |
| X"100" | arm_rst_sd      | 模块复位，先发’1’再给’0’  建议在每次启动前进行复位           |
| X"101" | sd_mode         | Bit0：全局模式  Bit1：行检测模式  Bit2：列检测模式  ‘1’使能该模式  全零则上传原始图像 |
| X"102" | arm_sd_start_en | 使能一帧图象处理，先发’1’再给’0’                             |
| X"104" | mask_addr_H     | 蒙版高地址位，0~7                                            |
| X"105" | mask_addr_L     | 蒙版低地址位，0~47                                           |
| X"109" | ddr3_base_addr  | /                                                            |
| X"10A" | sd_montage_en   | '0'奇异点检测结果不拼接，'1'检测结果拼接                     |
| X"110" | ko_up           | 全局 - 上门限系数，整数  4 bit，小数 4 bit  值为X”FF”时，则该门限失效（下同） |
| X"111" | ko_down         | 全局 - 下门限系数，整数  4 bit，小数 4 bit                   |
| X"112" | kr_up           | 行检测 - 上门限系数，整数  4 bit，小数 4 bit                 |
| X"113" | kr_down         | 行检测 - 下门限系数，整数  4 bit，小数 4 bit                 |
| X"114" | kc_up           | 列检测 - 上门限系数，整数  4 bit，小数 4 bit                 |
| X"115" | kc_down         | 列检测 - 下门限系数，整数  4 bit，小数 4 bit                 |

## 2     软件需求分析

1)    原始图象与蒙版进行与运算；

2)    蒙版的个数以及地址分配参见相关文档；

3)    统计整幅图象非零值点的均值和标准差；

4)    按行统计整幅图象非零值点的均值和标准差；

5)    按列统计整幅图象非零值点的均值和标准差；

6)    按整图、行、列参数计算过门限奇异点，根据下发控制模式进行或操作（任一模式开启，在该模式下判定为奇异点即为奇异点）

## 3    伤痕检测FPGA模块分解

伤痕检测FPGA模块根据功能分为三个组成部分：

Ø 图象接收处理模块；

Ø 伤痕检测模块；

Ø DDR3访问控制模块。